---
layout: post
title: 图像编辑之一键特效
---


最近三国杀1V1V1氛围渐弱，各位搞毛男都有了自己的新G点，比如亚龙整天窝那搞安卓，至于老汉就别提了，你们懂的。时间充裕了，就可以考虑把图片编辑部分做个阶段性结尾—-实际上也是因为TinyImage的Demo基本都已经整完了，今天讲讲一些有趣点的一键特效的实现，也算是收尾了————如果以后还有些有意思的效果可以考虑再写，至少目前这部分可以收尾了。

特效有很多，比如校内的那个照片美容工坊就提供了8种特效：黑白，反相，阿宝色调等等。但其中有些就比较无趣了，如黑白，反相等。所以这篇博文主要讲讲几种还算比较有趣的特效的实现：Lomo，反转负冲和柔光。下面会讲到这几种特效的实现方法，但是要注意的是这并不是唯一的方法：特效讲究是的更多是一种感觉，在一定的方法处理后照片是否会呈现预先所期望的效果，而不是如数学公式般精确。

##Lomo
Lomo指的是Lomo式的新摄影风格，它不注重构图、对焦，也不用调焦距、光圈，只要能体现自己的思想，引起观者的共鸣就算成功了，展现的是一种随意、不拘谨的生活态度。从视觉上来说Lomo特效的最大特点是：色彩浓郁，偏绿偏黄，有明显的暗角。

* 进行色彩平衡 的调整，增加图片中青黄比例 (具体比例可以自己确定，一键特效中这个比例是固定的)
* 调整色阶 ，使得图片偏暗
* 增加暗角


前两步无需多说，可以参考我前面的几篇文章里面的方法。重要的是第三步：建立一个和原图一样大的全黑蒙层，并画一个刚好内嵌于原图的椭圆。以这个椭圆为边界，椭圆内为全透明(即不处理)，椭圆外的点计算它到两个焦点的距离d，并计算椭圆上的点到两焦点的距离mindist和图片顶点到两焦点的距离maxdist，最后计算得到该点的透明度为 ： 
> alpha = 255 * ((d – mindist) / (maxdist – d))^2。 

将这个蒙层和原图进行融合就获得了中间亮到四个角渐暗的暗角效果。

##反转负冲

“反转负冲”是在胶片拍摄中比较特殊的一种手法。就是用负片的冲洗工艺来冲洗反转片，这样会得到比较诡异而且有趣的色彩。如果用在MM人像照片上，则会令弥漫着一种前卫甚至颓颓的色彩。


反转负冲的实现最主要的是进行不同通道上的图层的混合，至于在混合之后调整亮度之类的操作就可有可无，只是为了按照个人主观意愿来进行一种调整，并不属于整个特效的核心部分。


* 在蓝色通道，将该通道反相并与原通道上的图层进行正片叠底混合，透明度选择为50%。
* 在绿色通道，将该通道反相并与原通道上的图层进行正片叠底混合，透明度选择为20%。
* 在红色通道，进行颜色加深的图片混合，透明度为100%
* 进行适当的色阶的调整

这种效果的实现非常简单，相应的图层混合可以参考上一篇博文《图片编辑之图层混合》

##柔光
使图片产生一种朦胧和柔和的感觉。

* 拷贝一份原图，并进行高斯模糊(高斯模糊的半径设置得越大，效果越朦胧)
* 将原图适当调亮
* 以原图为底图，高斯模糊后的图片为上层图做滤色混合 (实际上哪个为底图并不影响最后结果)
整个操作中除了高斯模糊可能稍显复杂外，其他步骤都很简单，而高斯函数基本上所有的图像库都会提供相应的代码，完全可以拿来参考。

让我们来看下最后的效果。

###原图

![此处输入图片的描述][1]

###Lomo

![此处输入图片的描述][2]

###反转负冲

![此处输入图片的描述][3]

###柔光

![此处输入图片的描述][4]

TinyImage也初步搞定，上个链接：[TinyImage][5]（需要.NET 2.0支持）


  [1]: /images/ip_source.jpg
  [2]: /images/ip_lomo.jpg
  [3]: /images/ip_fz.jpg
  [4]: /images/ip_soft.jpg
  [5]: https://github.com/xiangwangfeng/tinyimage
